<html>
<body>
<h3 id="day"></h3>
<p id="banner"></p>

<table id="table" style="white-space:pre"></table>
</body>
<script>
var schedule = [,["Monday",[810,900,"1st Period"],[905,1000,"2nd Period"],[1000,1010,"Brunch"],[1015,1105,"3rd Period"],[1110,1200,"4th Period"],[1200,1245,"Lunch"],[1250,1340,"5th Period"],[1345,1435,"6th Period"],[1440,1530,"7th Period"]],["Tuesday",[810,855,"1st Period"],[900,950,"2nd Period"],[950,1000,"Brunch"],[1005,1050,"3rd Period"],[1055,1125,"Tutorial"],[1130,1215,"4th Period"],[1215,1300,"Lunch"],[1305,1350,"5th Period"],[1355,1440,"6th Period"],[1445,1530,"7th Period"]],["Wednesday",[850,1025,"2nd Period"],[1025,1040,"Brunch"],[1045,1215,"4th Period"],[1215,1300,"Lunch"],[1305,1435,"6th Period"]],["Thursday",[810,945,"1st Period"],[945,1000,"Brunch"],[1005,1135,"3rd Period"],[1135,1220,"Lunch"],[1225,1355,"5th Period"],[1400,1530,"7th Period"]],["Friday",[810,900,"1st Period"],[905,1000,"2nd Period"],[1000,1010,"Brunch"],[1015,1105,"3rd Period"],[1110,1200,"4th Period"],[1200,1245,"Lunch"],[1250,1340,"5th Period"],[1345,1435,"6th Period"],[1440,1530,"7th Period"]]];

function formatTime(t){
    if(Math.floor(t/100) > 12){
    	t -= 1200;
    }
    return t.toString().replace(/(\d\d)$/,":$1");
};

function createTimeString(m, s, short){
	var h = m / 60 | 0;
    
    m = m % 60;
    if(h > 0){
    	if(short){
        	return h + "h " + m + "m " + s + "s";
        }
        else {
    		return h + " hours, " + m + " minutes, and " + s + " seconds";
        }
    }
    else if(m > 0){
        if(short){
        	return m + "m " + s + "s";
        }
        else {
        	return m + " minutes and " + s + " seconds";
    	}
    }
    else {
    	if(short){
        	return s + "s";
        }
    	else {
        	return s + " seconds";
    	}
    }
}

(function tick(){
	var banner = document.getElementById("banner"),
	    date = new Date(),
    	hours = date.getHours(),
		mins = date.getMinutes(),
    	currTime = hours * 100 + mins,
		day = schedule[date.getDay()];
    
	if(currTime >= day[1][0] && currTime < day[day.length-1][1]){
    	var period;
        for(var i = 1; i < day.length; i++){
        	if(currTime >= day[i][0] && currTime < day[i][1]){
            	period = day[i];
            }
        }
        if(period){
        	var minutesLeft = ((period[1]/100|0) - hours) * 60+ period[1] % 100 - mins,
        	    secondsLeft = date.getSeconds();
            if(secondsLeft != 0){
            	minutesLeft--;
                secondsLeft = 60 - secondsLeft;
            }
        	banner.innerHTML = period[2] + " ends in: " + createTimeString(minutesLeft, secondsLeft, false);
       		document.title = createTimeString(minutesLeft, secondsLeft, true);
    	} else {
    		banner.innerHTML = document.title=("Passing Period");
    	}
	} else {
		banner.innerHTML=document.title=("No School");
	}
	document.getElementById("day").innerHTML=day[0];
	setTimeout(tick,+new Date() % 1000);
})();

table = document.getElementById("table");

table.appendChild(row = document.createElement("tr"));

var day = schedule[new Date().getDay()];

for(i = 1; i < day.length; i++){
    table.appendChild(row = document.createElement("tr"));
    timeentry = document.createElement("td");
    arr = day[i]
    if(arr){
    	timeentry.innerHTML = arr[2] + "\n" + formatTime(arr[0])+" - " + formatTime(arr[1]);
    }
    row.appendChild(timeentry);
}
</script>
<style>
* {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
}
table, td {
    border: 1px solid black;
    border-collapse: collapse;
}
</style>
</html>
